include 'precision_vars.f90'

module globaldata
  use precision_vars
  implicit none

! Index variables
  integer :: i, j
! Number of grid points
  integer :: jmax
! Order of Accuracy
  integer :: order
! Array for grid points
  real(wp), allocatable :: x(:)
! Array for solution data
  real(wp), allocatable :: u(:)
! Array for dU/dt data
  real(wp), allocatable :: q(:)
! du book-keeping
  real(wp), allocatable :: du(:)
! Left grid point
  real(wp) :: xmin
! Right grid point
  real(wp) :: xmax
! Grid spacing
  real(wp) :: delta_x
! Starting time
  real(wp) :: time
! Separation Constant
  real(wp) :: alpha
! Viscosity
  real(wp) :: eps = 0.25_wp
! Energy Collection Term
  real(wp) :: p
! Energy
  real(wp), allocatable :: e(:)
! Time
  real(wp), allocatable :: t(:)
! L2 error norm
  real(wp) :: L2error
! Linf error norm
  real(wp) :: Linferror

  contains

! Function defining initial condition
  function g(xn,tn)
  real(wp), intent(in) :: xn,tn
  real(wp) g
!  g = -0.1_wp*xn
  g = 1.0_wp-tanh((xn-tn+5.0_wp)/(2.0_wp*eps))
!  write(*,*) v, (xn-tn+5.0_wp)/(2.0_wp*v)
!  write(*,*) xn, tn, g
!  g = (4.0_wp*xn)/(xn**2+2.0_wp*tn+0.025_wp)
  end function g

! Function defining left boundary condition
  function gl(xn,tn)
  real(wp), intent(in) :: xn, tn
  real(wp) gl
!  gl = 1.0_wp
  gl = 2.0_wp
  end function gl

! Function defining right boundary condition
  function gr(xn,tn)
  real(wp), intent(in) :: xn, tn
  real(wp) gr
!  gr = -1.0_wp
  gr = 0.0_wp
  end function gr

end module globaldata

module fluxfunctions

  use precision_vars
  use globaldata
  implicit none

! Number of stencil points
  integer :: nbstencil
! Number of nonzeros in interpolation
  integer :: nnzint
! Offsets between flux grid and solution point grid
  integer, allocatable :: jIsts(:)
  integer, allocatable :: jIste(:)
! Offsets between flux grid and solution point grid (viscous)
  integer, allocatable :: jVsts(:)
  integer, allocatable :: jVste(:)
! Inviscid flux coefficients
  real(wp), allocatable :: fint(:,:)
! Viscous flux coefficients
  real(wp), allocatable :: fvint(:,:)
! P norm inverse scaled by inverse dx
  real(wp), allocatable :: pinvdx(:,:)
! Rbar matrix
  real(wp), allocatable :: rbar(:,:)

  contains

  subroutine initpinvdx

    allocate(pinvdx(10,4))

    pinvdx = 0.0_wp
!   Second Order
    pinvdx(1,1) = 2.0_wp
    pinvdx(2,1) = 1.0_wp
!   Fourth Order
    pinvdx(1,2) = 2.8235294117647058823529411764705882353_wp
    pinvdx(2,2) = 0.81355932203389830508474576271186440678_wp
    pinvdx(3,2) = 1.1162790697674418604651162790697674419_wp
    pinvdx(4,2) = 0.97959183673469387755102040816326530612_wp
    pinvdx(5,2) = 1.0000000000000000000000000000000000000_wp
!   Sixth Order
    pinvdx(1,3) = 3.2432432432432432432432432432432432432_wp
    pinvdx(2,3) = 0.69633617563145763148986927577813955737_wp
    pinvdx(3,3) = 1.9481397970687711386696730552423900789_wp
    pinvdx(4,3) = 0.71796576366960279208908093734419145754_wp
    pinvdx(5,3) = 1.2539912917271407837445573294629898403_wp
    pinvdx(6,3) = 0.94374658656471873293282359366466411797_wp
    pinvdx(7,3) = 1.0076741853467378880828532107951762264_wp
    pinvdx(8,3) = 1.0000000000000000000000000000000000000_wp
!   Eigth Order
    pinvdx(1,4) = 3.3388981636060100166944908180300500835_wp
    pinvdx(2,4) = 0.67166112386355419609800361200830541810_wp
    pinvdx(3,4) = 2.5872287805246011319981479868054754454_wp
    pinvdx(4,4) = 0.64935420500331280158653723817674480927_wp
    pinvdx(5,4) = 1.3598768136281481908969048637106484335_wp
    pinvdx(6,4) = 0.98004386754996649194151043751580269422_wp
    pinvdx(7,4) = 0.95024819106399044849734934488965855641_wp
    pinvdx(8,4) = 1.0283207025316559720897982867102527893_wp
    pinvdx(9,4) = 0.99541182456421479599641740148968966041_wp
    pinvdx(10,4) = 1.0000000000000000000000000000000000000_wp

  end subroutine initpinvdx

  subroutine initfint()

    ! number of boundary stencils
    nbstencil = 1
    ! number of nonzeros in interpolation
    nnzint = 4

    allocate(fint(nnzint,nbstencil+1))
    allocate(jIsts(nbstencil+1))
    allocate(jIste(nbstencil+1))
    fint = 0.0_wp
    fint(1,1) = 1.0_wp
    fint(1,2) = 1.0_wp/3.0_wp
    fint(2,2) = 1.0_wp/6.0_wp
    fint(3,2) = 1.0_wp/6.0_wp
    fint(4,2) = 1.0_wp/3.0_wp
    jIsts(1) = 1
    jIste(1) = 1
    jIsts(2) = 0
    jIste(2) = 1

  end subroutine initfint

  subroutine initfint4()

    ! number of boundary stencils
    nbstencil = 4
    ! number of nonzeros in interpolation
    nnzint = 25

    allocate(fint(nnzint,nbstencil+1))
    allocate(jIsts(nbstencil+1))
    allocate(jIste(nbstencil+1))
    jIsts(1) = 1
    jIste(1) = 1
    jIsts(2) = 0
    jIste(2) = 3
    jIsts(3) = -1
    jIste(3) = 2
    jIsts(4) = -2
    jIste(4) = 2
    jIsts(5) = -1
    jIste(5) = 2
    fint = 0.0_wp
    fint(1,1) = 0.0000000000000000000000000000_wp*alpha + 1.000000000000000000000000000_wp
    fint(1,2) = 0.5000000000000000000000000000_wp * alpha + 0.0000000000000000000000000000_wp
    fint(2,2) = -0.6145833333333333333333333333_wp * alpha + 0.6145833333333333333333333333_wp
    fint(3,2) = 0.08333333333333333333333333333_wp * alpha - 0.08333333333333333333333333333_wp
    fint(4,2) = 0.03125000000000000000000000000_wp * alpha - 0.03125000000000000000000000000_wp
    fint(5,2) = -0.6145833333333333333333333333_wp * alpha + 0.6145833333333333333333333333_wp
    fint(6,2) = 0.6145833333333333333333333333_wp * alpha + 0.0000000000000000000000000000_wp
    fint(7,2) = 0.0000000000000000000000000000_wp * alpha + 0.0000000000000000000000000000_wp
    fint(8,2) = 0.0000000000000000000000000000_wp * alpha + 0.0000000000000000000000000000_wp
    fint(9,2) = 0.08333333333333333333333333333_wp * alpha - 0.08333333333333333333333333333_wp
    fint(10,2) = 0.0000000000000000000000000000_wp * alpha + 0.0000000000000000000000000000_wp
    fint(11,2) = -0.08333333333333333333333333333_wp * alpha + 0.0000000000000000000000000000_wp
    fint(12,2) = 0.0000000000000000000000000000_wp * alpha + 0.0000000000000000000000000000_wp
    fint(13,2) = 0.03125000000000000000000000000_wp * alpha - 0.03125000000000000000000000000_wp
    fint(14,2) = 0.0000000000000000000000000000_wp * alpha + 0.0000000000000000000000000000_wp
    fint(15,2) = 0.0000000000000000000000000000_wp * alpha + 0.0000000000000000000000000000_wp
    fint(16,2) = -0.03125000000000000000000000000_wp * alpha + 0.0000000000000000000000000000_wp
    fint(1,3) = -0.1145833333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,3) = 0.08333333333333333333333333333_wp*alpha - 0.08333333333333333333333333333_wp
    fint(4,3) = 0.03125000000000000000000000000_wp*alpha - 0.03125000000000000000000000000_wp
    fint(5,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(6,3) = 0.6145833333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,3) = -0.6145833333333333333333333333_wp*alpha + 0.6145833333333333333333333333_wp
    fint(8,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,3) = 0.08333333333333333333333333333_wp*alpha - 0.08333333333333333333333333333_wp
    fint(10,3) = -0.6145833333333333333333333333_wp*alpha + 0.6145833333333333333333333333_wp
    fint(11,3) = 0.5312500000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,3) = 0.03125000000000000000000000000_wp*alpha - 0.03125000000000000000000000000_wp
    fint(14,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,3) = -0.03125000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,4) = -0.03125000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,4) = 0.03125000000000000000000000000_wp*alpha - 0.03125000000000000000000000000_wp
    fint(5,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(6,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,4) = 0.5312500000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,4) = -0.6145833333333333333333333333_wp*alpha + 0.6145833333333333333333333333_wp
    fint(15,4) = 0.08333333333333333333333333333_wp*alpha - 0.08333333333333333333333333333_wp
    fint(16,4) = 0.03125000000000000000000000000_wp*alpha - 0.03125000000000000000000000000_wp
    fint(17,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,4) = -0.6145833333333333333333333333_wp*alpha + 0.6145833333333333333333333333_wp
    fint(19,4) = 0.5833333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,4) = 0.08333333333333333333333333333_wp*alpha - 0.08333333333333333333333333333_wp
    fint(24,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,4) = -0.08333333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,5) = -0.08333333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,5) = 0.08333333333333333333333333333_wp*alpha - 0.08333333333333333333333333333_wp
    fint(4,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(6,5) = 0.5833333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,5) = -0.6666666666666666666666666667_wp*alpha + 0.6666666666666666666666666667_wp
    fint(8,5) = 0.08333333333333333333333333333_wp*alpha - 0.08333333333333333333333333333_wp
    fint(9,5) = 0.08333333333333333333333333333_wp*alpha - 0.08333333333333333333333333333_wp
    fint(10,5) = -0.6666666666666666666666666667_wp*alpha + 0.6666666666666666666666666667_wp
    fint(11,5) = 0.5833333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,5) = 0.08333333333333333333333333333_wp*alpha - 0.08333333333333333333333333333_wp
    fint(15,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,5) = -0.08333333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp

  end subroutine initfint4

  subroutine initfint6()

    ! number of boundary stencils
    nbstencil = 7
    ! number of nonzeros in interpolation
    nnzint = 49

    allocate(fint(nnzint,nbstencil+1))
    allocate(jIsts(nbstencil+1))
    allocate(jIste(nbstencil+1))
    jIsts(1) = 1
    jIste(1) = 1
    jIsts(2) = 0
    jIste(2) = 4
    jIsts(3) = -1
    jIste(3) = 4
    jIsts(4) = -2
    jIste(4) = 4
    jIsts(5) = -3
    jIste(5) = 3
    jIsts(6) = -3
    jIste(6) = 3
    jIsts(7) = -3
    jIste(7) = 3
    jIsts(8) = -2
    jIste(8) = 3
    fint = 0.0_wp
    fint(1,1) = 0.0000000000000000000000000000_wp*alpha + 1.000000000000000000000000000_wp
    fint(1,2) = 0.5000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,2) = -0.6638888888888888888888888889_wp*alpha + 0.6638888888888888888888888889_wp
    fint(3,2) = 0.07083333333333333333333333333_wp*alpha - 0.07083333333333333333333333333_wp
    fint(4,2) = 0.1583333333333333333333333333_wp*alpha - 0.1583333333333333333333333333_wp
    fint(5,2) = -0.06527777777777777777777777778_wp*alpha + 0.06527777777777777777777777778_wp
    fint(6,2) = -0.6638888888888888888888888889_wp*alpha + 0.6638888888888888888888888889_wp
    fint(7,2) = 0.6638888888888888888888888889_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,2) = 0.07083333333333333333333333333_wp*alpha - 0.07083333333333333333333333333_wp
    fint(12,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,2) = -0.07083333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,2) = 0.1583333333333333333333333333_wp*alpha - 0.1583333333333333333333333333_wp
    fint(17,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,2) = -0.1583333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,2) = -0.06527777777777777777777777778_wp*alpha + 0.06527777777777777777777777778_wp
    fint(22,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,2) = 0.06527777777777777777777777778_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,3) = -0.1638888888888888888888888889_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,3) = 0.07083333333333333333333333333_wp*alpha - 0.07083333333333333333333333333_wp
    fint(4,3) = 0.1583333333333333333333333333_wp*alpha - 0.1583333333333333333333333333_wp
    fint(5,3) = -0.06527777777777777777777777778_wp*alpha + 0.06527777777777777777777777778_wp
    fint(6,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,3) = 0.6638888888888888888888888889_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,3) = -0.4158410493827160493827160494_wp*alpha + 0.4158410493827160493827160494_wp
    fint(10,3) = -0.3650578703703703703703703704_wp*alpha + 0.3650578703703703703703703704_wp
    fint(11,3) = 0.09428240740740740740740740741_wp*alpha - 0.09428240740740740740740740741_wp
    fint(12,3) = 0.02272762345679012345679012346_wp*alpha - 0.02272762345679012345679012346_wp
    fint(13,3) = 0.07083333333333333333333333333_wp*alpha - 0.07083333333333333333333333333_wp
    fint(14,3) = -0.4158410493827160493827160494_wp*alpha + 0.4158410493827160493827160494_wp
    fint(15,3) = 0.3450077160493827160493827161_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,3) = 0.1583333333333333333333333333_wp*alpha - 0.1583333333333333333333333333_wp
    fint(20,3) = -0.3650578703703703703703703704_wp*alpha + 0.3650578703703703703703703704_wp
    fint(21,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,3) = 0.2067245370370370370370370370_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,3) = -0.06527777777777777777777777778_wp*alpha + 0.06527777777777777777777777778_wp
    fint(26,3) = 0.09428240740740740740740740741_wp*alpha - 0.09428240740740740740740740741_wp
    fint(27,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,3) = -0.02900462962962962962962962963_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,3) = 0.02272762345679012345679012346_wp*alpha - 0.02272762345679012345679012346_wp
    fint(33,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(34,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(35,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(36,3) = -0.02272762345679012345679012346_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,4) = -0.09305555555555555555555555556_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,4) = 0.1583333333333333333333333333_wp*alpha - 0.1583333333333333333333333333_wp
    fint(5,4) = -0.06527777777777777777777777778_wp*alpha + 0.06527777777777777777777777778_wp
    fint(6,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,4) = 0.2480478395061728395061728395_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,4) = -0.3650578703703703703703703704_wp*alpha + 0.3650578703703703703703703704_wp
    fint(12,4) = 0.09428240740740740740740740741_wp*alpha - 0.09428240740740740740740740741_wp
    fint(13,4) = 0.02272762345679012345679012346_wp*alpha - 0.02272762345679012345679012346_wp
    fint(14,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,4) = 0.3450077160493827160493827161_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,4) = -0.5173996913580246913580246914_wp*alpha + 0.5173996913580246913580246914_wp
    fint(19,4) = 0.2528742283950617283950617284_wp*alpha - 0.2528742283950617283950617284_wp
    fint(20,4) = -0.09444444444444444444444444444_wp*alpha + 0.09444444444444444444444444444_wp
    fint(21,4) = 0.01396219135802469135802469136_wp*alpha - 0.01396219135802469135802469136_wp
    fint(22,4) = 0.1583333333333333333333333333_wp*alpha - 0.1583333333333333333333333333_wp
    fint(23,4) = -0.3650578703703703703703703704_wp*alpha + 0.3650578703703703703703703704_wp
    fint(24,4) = -0.5173996913580246913580246914_wp*alpha + 0.5173996913580246913580246914_wp
    fint(25,4) = 0.7241242283950617283950617284_wp*alpha + 0.0000000000000000000000000000_wp
    fint(26,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(27,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,4) = -0.06527777777777777777777777778_wp*alpha + 0.06527777777777777777777777778_wp
    fint(30,4) = 0.09428240740740740740740740741_wp*alpha - 0.09428240740740740740740740741_wp
    fint(31,4) = 0.2528742283950617283950617284_wp*alpha - 0.2528742283950617283950617284_wp
    fint(32,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,4) = -0.2818788580246913580246913580_wp*alpha + 0.0000000000000000000000000000_wp
    fint(34,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(35,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(36,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(37,4) = 0.02272762345679012345679012346_wp*alpha - 0.02272762345679012345679012346_wp
    fint(38,4) = -0.09444444444444444444444444444_wp*alpha + 0.09444444444444444444444444444_wp
    fint(39,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(40,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,4) = 0.07171682098765432098765432099_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(43,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(44,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(45,4) = 0.01396219135802469135802469136_wp*alpha - 0.01396219135802469135802469136_wp
    fint(46,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(47,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(48,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(49,4) = -0.01396219135802469135802469136_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,5) = 0.06527777777777777777777777778_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,5) = -0.06527777777777777777777777778_wp*alpha + 0.06527777777777777777777777778_wp
    fint(6,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,5) = -0.1170100308641975308641975309_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,5) = 0.09428240740740740740740740741_wp*alpha - 0.09428240740740740740740740741_wp
    fint(13,5) = 0.02272762345679012345679012346_wp*alpha - 0.02272762345679012345679012346_wp
    fint(14,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,5) = -0.1723919753086419753086419753_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,5) = 0.2528742283950617283950617284_wp*alpha - 0.2528742283950617283950617284_wp
    fint(20,5) = -0.09444444444444444444444444444_wp*alpha + 0.09444444444444444444444444444_wp
    fint(21,5) = 0.01396219135802469135802469136_wp*alpha - 0.01396219135802469135802469136_wp
    fint(22,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,5) = 0.7241242283950617283950617284_wp*alpha + 0.0000000000000000000000000000_wp
    fint(26,5) = -0.8979166666666666666666666667_wp*alpha + 0.8979166666666666666666666667_wp
    fint(27,5) = 0.2437692901234567901234567901_wp*alpha - 0.2437692901234567901234567901_wp
    fint(28,5) = -0.06997685185185185185185185185_wp*alpha + 0.06997685185185185185185185185_wp
    fint(29,5) = -0.06527777777777777777777777778_wp*alpha + 0.06527777777777777777777777778_wp
    fint(30,5) = 0.09428240740740740740740740741_wp*alpha - 0.09428240740740740740740740741_wp
    fint(31,5) = 0.2528742283950617283950617284_wp*alpha - 0.2528742283950617283950617284_wp
    fint(32,5) = -0.8979166666666666666666666667_wp*alpha + 0.8979166666666666666666666667_wp
    fint(33,5) = 0.6160378086419753086419753086_wp*alpha + 0.0000000000000000000000000000_wp
    fint(34,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(35,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(36,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(37,5) = 0.02272762345679012345679012346_wp*alpha - 0.02272762345679012345679012346_wp
    fint(38,5) = -0.09444444444444444444444444444_wp*alpha + 0.09444444444444444444444444444_wp
    fint(39,5) = 0.2437692901234567901234567901_wp*alpha - 0.2437692901234567901234567901_wp
    fint(40,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,5) = -0.1720524691358024691358024691_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(43,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(44,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(45,5) = 0.01396219135802469135802469136_wp*alpha - 0.01396219135802469135802469136_wp
    fint(46,5) = -0.06997685185185185185185185185_wp*alpha + 0.06997685185185185185185185185_wp
    fint(47,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(48,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(49,5) = 0.05601466049382716049382716049_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,6) = -0.02272762345679012345679012346_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,6) = 0.02272762345679012345679012346_wp*alpha - 0.02272762345679012345679012346_wp
    fint(6,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,6) = 0.08048225308641975308641975309_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,6) = -0.09444444444444444444444444444_wp*alpha + 0.09444444444444444444444444444_wp
    fint(13,6) = 0.01396219135802469135802469136_wp*alpha - 0.01396219135802469135802469136_wp
    fint(14,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,6) = -0.1737924382716049382716049383_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,6) = 0.2437692901234567901234567901_wp*alpha - 0.2437692901234567901234567901_wp
    fint(20,6) = -0.06997685185185185185185185185_wp*alpha + 0.06997685185185185185185185185_wp
    fint(21,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,6) = 0.6160378086419753086419753086_wp*alpha + 0.0000000000000000000000000000_wp
    fint(26,6) = -0.8217206790123456790123456790_wp*alpha + 0.8217206790123456790123456790_wp
    fint(27,6) = 0.2223495370370370370370370370_wp*alpha - 0.2223495370370370370370370370_wp
    fint(28,6) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(29,6) = 0.02272762345679012345679012346_wp*alpha - 0.02272762345679012345679012346_wp
    fint(30,6) = -0.09444444444444444444444444444_wp*alpha + 0.09444444444444444444444444444_wp
    fint(31,6) = 0.2437692901234567901234567901_wp*alpha - 0.2437692901234567901234567901_wp
    fint(32,6) = -0.8217206790123456790123456790_wp*alpha + 0.8217206790123456790123456790_wp
    fint(33,6) = 0.6496682098765432098765432099_wp*alpha + 0.0000000000000000000000000000_wp
    fint(34,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(35,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(36,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(37,6) = 0.01396219135802469135802469136_wp*alpha - 0.01396219135802469135802469136_wp
    fint(38,6) = -0.06997685185185185185185185185_wp*alpha + 0.06997685185185185185185185185_wp
    fint(39,6) = 0.2223495370370370370370370370_wp*alpha - 0.2223495370370370370370370370_wp
    fint(40,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,6) = -0.1663348765432098765432098765_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(43,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(44,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(45,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(46,6) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(47,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(48,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(49,6) = 0.01666666666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,7) = -0.01396219135802469135802469136_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,7) = 0.01396219135802469135802469136_wp*alpha - 0.01396219135802469135802469136_wp
    fint(6,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,7) = 0.06997685185185185185185185185_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,7) = -0.06997685185185185185185185185_wp*alpha + 0.06997685185185185185185185185_wp
    fint(13,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,7) = -0.2056828703703703703703703704_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,7) = 0.2223495370370370370370370370_wp*alpha - 0.2223495370370370370370370370_wp
    fint(20,7) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(21,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,7) = 0.6496682098765432098765432099_wp*alpha + 0.0000000000000000000000000000_wp
    fint(26,7) = -0.7830015432098765432098765432_wp*alpha + 0.7830015432098765432098765432_wp
    fint(27,7) = 0.1500000000000000000000000000_wp*alpha - 0.1500000000000000000000000000_wp
    fint(28,7) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(29,7) = 0.01396219135802469135802469136_wp*alpha - 0.01396219135802469135802469136_wp
    fint(30,7) = -0.06997685185185185185185185185_wp*alpha + 0.06997685185185185185185185185_wp
    fint(31,7) = 0.2223495370370370370370370370_wp*alpha - 0.2223495370370370370370370370_wp
    fint(32,7) = -0.7830015432098765432098765432_wp*alpha + 0.7830015432098765432098765432_wp
    fint(33,7) = 0.6166666666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp
    fint(34,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(35,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(36,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(37,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(38,7) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(39,7) = 0.1500000000000000000000000000_wp*alpha - 0.1500000000000000000000000000_wp
    fint(40,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,7) = -0.1333333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(43,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(44,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(45,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(46,7) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(47,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(48,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(49,7) = 0.01666666666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,8) = 0.01666666666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,8) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(5,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(6,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,8) = -0.1333333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,8) = 0.1500000000000000000000000000_wp*alpha - 0.1500000000000000000000000000_wp
    fint(11,8) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(12,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,8) = 0.6166666666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,8) = -0.7500000000000000000000000000_wp*alpha + 0.7500000000000000000000000000_wp
    fint(17,8) = 0.1500000000000000000000000000_wp*alpha - 0.1500000000000000000000000000_wp
    fint(18,8) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(19,8) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(20,8) = 0.1500000000000000000000000000_wp*alpha - 0.1500000000000000000000000000_wp
    fint(21,8) = -0.7500000000000000000000000000_wp*alpha + 0.7500000000000000000000000000_wp
    fint(22,8) = 0.6166666666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(26,8) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(27,8) = 0.1500000000000000000000000000_wp*alpha - 0.1500000000000000000000000000_wp
    fint(28,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,8) = -0.1333333333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,8) = -0.01666666666666666666666666667_wp*alpha + 0.01666666666666666666666666667_wp
    fint(34,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(35,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(36,8) = 0.01666666666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp

  end subroutine initfint6

  subroutine initfint8()

    ! number of boundary stencils
    nbstencil = 9
    ! number of nonzeros in interpolation
    nnzint = 81

    allocate(fint(nnzint,nbstencil+1))
    allocate(jIsts(nbstencil+1))
    allocate(jIste(nbstencil+1))
    jIsts(1) = 1
    jIste(1) = 1
    jIsts(2) = 0
    jIste(2) = 5
    jIsts(3) = -1
    jIste(3) = 5
    jIsts(4) = -2
    jIste(4) = 5
    jIsts(5) = -3
    jIste(5) = 5
    jIsts(6) = -4
    jIste(6) = 4
    jIsts(7) = -4
    jIste(7) = 4
    jIsts(8) = -4
    jIste(8) = 4
    jIsts(9) = -4
    jIste(9) = 4
    jIsts(10) = -3
    jIste(10) = 4
    fint = 0.0_wp
    fint(1,1) = 0.0000000000000000000000000000_wp*alpha + 1.000000000000000000000000000_wp
    fint(1,2) = 0.5000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,2) = -0.5782083333333333333333333333_wp*alpha + 0.5782083333333333333333333333_wp
    fint(3,2) = -0.3410833333333333333333333333_wp*alpha + 0.3410833333333333333333333333_wp
    fint(4,2) = 0.8402500000000000000000000000_wp*alpha - 0.8402500000000000000000000000_wp
    fint(5,2) = -0.5449166666666666666666666667_wp*alpha + 0.5449166666666666666666666667_wp
    fint(6,2) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(7,2) = -0.5782083333333333333333333333_wp*alpha + 0.5782083333333333333333333333_wp
    fint(8,2) = 0.5782083333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,2) = -0.3410833333333333333333333333_wp*alpha + 0.3410833333333333333333333333_wp
    fint(14,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,2) = 0.3410833333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,2) = 0.8402500000000000000000000000_wp*alpha - 0.8402500000000000000000000000_wp
    fint(20,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,2) = -0.8402500000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,2) = -0.5449166666666666666666666667_wp*alpha + 0.5449166666666666666666666667_wp
    fint(26,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(27,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,2) = 0.5449166666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,2) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(32,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(34,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(35,2) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(36,2) = -0.1239583333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,3) = -0.07820833333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,3) = -0.3410833333333333333333333333_wp*alpha + 0.3410833333333333333333333333_wp
    fint(4,3) = 0.8402500000000000000000000000_wp*alpha - 0.8402500000000000000000000000_wp
    fint(5,3) = -0.5449166666666666666666666667_wp*alpha + 0.5449166666666666666666666667_wp
    fint(6,3) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(7,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,3) = 0.5782083333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,3) = 0.8803037138080540858318636096_wp*alpha - 0.8803037138080540858318636096_wp
    fint(11,3) = -3.422754260886453346770807088_wp*alpha + 3.422754260886453346770807088_wp
    fint(12,3) = 3.013122649754346182917611489_wp*alpha - 3.013122649754346182917611489_wp
    fint(13,3) = -1.259601338760812967162173511_wp*alpha + 1.259601338760812967162173511_wp
    fint(14,3) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(15,3) = -0.3410833333333333333333333333_wp*alpha + 0.3410833333333333333333333333_wp
    fint(16,3) = 0.8803037138080540858318636096_wp*alpha - 0.8803037138080540858318636096_wp
    fint(17,3) = -0.5392203804747207524985302763_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,3) = 0.8402500000000000000000000000_wp*alpha - 0.8402500000000000000000000000_wp
    fint(23,3) = -3.422754260886453346770807088_wp*alpha + 3.422754260886453346770807088_wp
    fint(24,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,3) = 2.582504260886453346770807088_wp*alpha + 0.0000000000000000000000000000_wp
    fint(26,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(27,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,3) = -0.5449166666666666666666666667_wp*alpha + 0.5449166666666666666666666667_wp
    fint(30,3) = 3.013122649754346182917611489_wp*alpha - 3.013122649754346182917611489_wp
    fint(31,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,3) = -2.468205983087679516250944822_wp*alpha + 0.0000000000000000000000000000_wp
    fint(34,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(35,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(36,3) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(37,3) = -1.259601338760812967162173511_wp*alpha + 1.259601338760812967162173511_wp
    fint(38,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(39,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(40,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,3) = 1.135643005427479633828840178_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(43,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(44,3) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(45,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(46,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(47,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(48,3) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(49,3) = -0.2107209027515327118501721676_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,4) = -0.4192916666666666666666666667_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,4) = 0.8402500000000000000000000000_wp*alpha - 0.8402500000000000000000000000_wp
    fint(5,4) = -0.5449166666666666666666666667_wp*alpha + 0.5449166666666666666666666667_wp
    fint(6,4) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(7,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,4) = 1.458512047141387419165196943_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,4) = -3.422754260886453346770807088_wp*alpha + 3.422754260886453346770807088_wp
    fint(13,4) = 3.013122649754346182917611489_wp*alpha - 3.013122649754346182917611489_wp
    fint(14,4) = -1.259601338760812967162173511_wp*alpha + 1.259601338760812967162173511_wp
    fint(15,4) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(16,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,4) = -0.5392203804747207524985302763_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,4) = 3.746770181143445032333921223_wp*alpha - 3.746770181143445032333921223_wp
    fint(21,4) = -6.291230553718400940623162845_wp*alpha + 6.291230553718400940623162845_wp
    fint(22,4) = 4.174189029431216931216931217_wp*alpha - 4.174189029431216931216931217_wp
    fint(23,4) = -1.181014228762492651381540270_wp*alpha + 1.181014228762492651381540270_wp
    fint(24,4) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(25,4) = 0.8402500000000000000000000000_wp*alpha - 0.8402500000000000000000000000_wp
    fint(26,4) = -3.422754260886453346770807088_wp*alpha + 3.422754260886453346770807088_wp
    fint(27,4) = 3.746770181143445032333921223_wp*alpha - 3.746770181143445032333921223_wp
    fint(28,4) = -1.164265920256991685563114135_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,4) = -0.5449166666666666666666666667_wp*alpha + 0.5449166666666666666666666667_wp
    fint(34,4) = 3.013122649754346182917611489_wp*alpha - 3.013122649754346182917611489_wp
    fint(35,4) = -6.291230553718400940623162845_wp*alpha + 6.291230553718400940623162845_wp
    fint(36,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(37,4) = 3.823024570630721424372218023_wp*alpha + 0.0000000000000000000000000000_wp
    fint(38,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(39,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(40,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,4) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(42,4) = -1.259601338760812967162173511_wp*alpha + 1.259601338760812967162173511_wp
    fint(43,4) = 4.174189029431216931216931217_wp*alpha - 4.174189029431216931216931217_wp
    fint(44,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(45,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(46,4) = -3.038546024003737297388091039_wp*alpha + 0.0000000000000000000000000000_wp
    fint(47,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(48,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(49,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(50,4) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(51,4) = -1.181014228762492651381540270_wp*alpha + 1.181014228762492651381540270_wp
    fint(52,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(53,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(54,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(55,4) = 0.9702933260109599395313681028_wp*alpha + 0.0000000000000000000000000000_wp
    fint(56,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(57,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(58,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(59,4) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(60,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(61,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(62,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(63,4) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(64,4) = -0.09050595238095238095238095238_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,5) = 0.4209583333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,5) = -0.5449166666666666666666666667_wp*alpha + 0.5449166666666666666666666667_wp
    fint(6,5) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(7,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,5) = -1.964242213745065927605610145_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,5) = 3.013122649754346182917611489_wp*alpha - 3.013122649754346182917611489_wp
    fint(15,5) = -1.259601338760812967162173511_wp*alpha + 1.259601338760812967162173511_wp
    fint(16,5) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(17,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,5) = 3.207549800668724279835390946_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,5) = -6.291230553718400940623162845_wp*alpha + 6.291230553718400940623162845_wp
    fint(24,5) = 4.174189029431216931216931217_wp*alpha - 4.174189029431216931216931217_wp
    fint(25,5) = -1.181014228762492651381540270_wp*alpha + 1.181014228762492651381540270_wp
    fint(26,5) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(27,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,5) = -1.164265920256991685563114135_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,5) = 5.104266143996178718400940623_wp*alpha - 5.104266143996178718400940623_wp
    fint(33,5) = -6.160792805702527924750146972_wp*alpha + 6.160792805702527924750146972_wp
    fint(34,5) = 2.637456845238095238095238095_wp*alpha - 2.637456845238095238095238095_wp
    fint(35,5) = -0.4262670212375073486184597296_wp*alpha + 0.4262670212375073486184597296_wp
    fint(36,5) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(37,5) = -0.5449166666666666666666666667_wp*alpha + 0.5449166666666666666666666667_wp
    fint(38,5) = 3.013122649754346182917611489_wp*alpha - 3.013122649754346182917611489_wp
    fint(39,5) = -6.291230553718400940623162845_wp*alpha + 6.291230553718400940623162845_wp
    fint(40,5) = 5.104266143996178718400940623_wp*alpha - 5.104266143996178718400940623_wp
    fint(41,5) = -1.281241573365457294028722600_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(43,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(44,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(45,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(46,5) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(47,5) = -1.259601338760812967162173511_wp*alpha + 1.259601338760812967162173511_wp
    fint(48,5) = 4.174189029431216931216931217_wp*alpha - 4.174189029431216931216931217_wp
    fint(49,5) = -6.160792805702527924750146972_wp*alpha + 6.160792805702527924750146972_wp
    fint(50,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(51,5) = 3.122246781698790627362055934_wp*alpha + 0.0000000000000000000000000000_wp
    fint(52,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(53,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(54,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(55,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(56,5) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(57,5) = -1.181014228762492651381540270_wp*alpha + 1.181014228762492651381540270_wp
    fint(58,5) = 2.637456845238095238095238095_wp*alpha - 2.637456845238095238095238095_wp
    fint(59,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(60,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(61,5) = -1.667163519227135298563869992_wp*alpha + 0.0000000000000000000000000000_wp
    fint(62,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(63,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(64,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(65,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(66,5) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(67,5) = -0.4262670212375073486184597296_wp*alpha + 0.4262670212375073486184597296_wp
    fint(68,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(69,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(70,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(71,5) = 0.3357610688565549676660787772_wp*alpha + 0.0000000000000000000000000000_wp
    fint(72,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(73,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(74,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(75,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(76,5) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(77,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(78,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(79,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(80,5) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(81,5) = -0.009602757962753002435542118082_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,6) = -0.1239583333333333333333333333_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(6,6) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(7,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,6) = 1.048880436009280255312001344_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,6) = -1.259601338760812967162173511_wp*alpha + 1.259601338760812967162173511_wp
    fint(16,6) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(17,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,6) = -3.083680753049676660787771899_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,6) = 4.174189029431216931216931217_wp*alpha - 4.174189029431216931216931217_wp
    fint(25,6) = -1.181014228762492651381540270_wp*alpha + 1.181014228762492651381540270_wp
    fint(26,6) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(27,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,6) = 3.940000223739187032837826489_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,6) = -6.160792805702527924750146972_wp*alpha + 6.160792805702527924750146972_wp
    fint(34,6) = 2.637456845238095238095238095_wp*alpha - 2.637456845238095238095238095_wp
    fint(35,6) = -0.4262670212375073486184597296_wp*alpha + 0.4262670212375073486184597296_wp
    fint(36,6) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(37,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(38,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(39,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(40,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,6) = -1.281241573365457294028722600_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,6) = 3.348572916666666666666666667_wp*alpha - 3.348572916666666666666666667_wp
    fint(43,6) = -2.779844099059376837154614932_wp*alpha + 2.779844099059376837154614932_wp
    fint(44,6) = 0.7558027860449735449735449735_wp*alpha - 0.7558027860449735449735449735_wp
    fint(45,6) = -0.04329003028680608045687410767_wp*alpha + 0.04329003028680608045687410767_wp
    fint(46,6) = 0.1239583333333333333333333333_wp*alpha - 0.1239583333333333333333333333_wp
    fint(47,6) = -1.259601338760812967162173511_wp*alpha + 1.259601338760812967162173511_wp
    fint(48,6) = 4.174189029431216931216931217_wp*alpha - 4.174189029431216931216931217_wp
    fint(49,6) = -6.160792805702527924750146972_wp*alpha + 6.160792805702527924750146972_wp
    fint(50,6) = 3.348572916666666666666666667_wp*alpha - 3.348572916666666666666666667_wp
    fint(51,6) = -0.2263261349678760393046107332_wp*alpha + 0.0000000000000000000000000000_wp
    fint(52,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(53,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(54,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(55,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(56,6) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(57,6) = -1.181014228762492651381540270_wp*alpha + 1.181014228762492651381540270_wp
    fint(58,6) = 2.637456845238095238095238095_wp*alpha - 2.637456845238095238095238095_wp
    fint(59,6) = -2.779844099059376837154614932_wp*alpha + 2.779844099059376837154614932_wp
    fint(60,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(61,6) = 1.112680579832241538590744940_wp*alpha + 0.0000000000000000000000000000_wp
    fint(62,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(63,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(64,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(65,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(66,6) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(67,6) = -0.4262670212375073486184597296_wp*alpha + 0.4262670212375073486184597296_wp
    fint(68,6) = 0.7558027860449735449735449735_wp*alpha - 0.7558027860449735449735449735_wp
    fint(69,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(70,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(71,6) = -0.4200417171884185773074661964_wp*alpha + 0.0000000000000000000000000000_wp
    fint(72,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(73,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(74,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(75,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(76,6) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(77,6) = -0.04329003028680608045687410767_wp*alpha + 0.04329003028680608045687410767_wp
    fint(78,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(79,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(80,6) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(81,6) = 0.03368727232405307802133198959_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,7) = -0.2107209027515327118501721676_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(6,7) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(7,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,7) = 1.090508276381540270429159318_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,7) = -1.181014228762492651381540270_wp*alpha + 1.181014228762492651381540270_wp
    fint(16,7) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(17,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,7) = -2.220792581963340891912320484_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,7) = 2.637456845238095238095238095_wp*alpha - 2.637456845238095238095238095_wp
    fint(25,7) = -0.4262670212375073486184597296_wp*alpha + 0.4262670212375073486184597296_wp
    fint(26,7) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(27,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,7) = 2.067331343301209372637944067_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,7) = -2.779844099059376837154614932_wp*alpha + 2.779844099059376837154614932_wp
    fint(34,7) = 0.7558027860449735449735449735_wp*alpha - 0.7558027860449735449735449735_wp
    fint(35,7) = -0.04329003028680608045687410767_wp*alpha + 0.04329003028680608045687410767_wp
    fint(36,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(37,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(38,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(39,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(40,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,7) = -0.2263261349678760393046107332_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,7) = 0.6628848976704879482657260435_wp*alpha - 0.6628848976704879482657260435_wp
    fint(43,7) = -0.4919167677101704879482657260_wp*alpha + 0.4919167677101704879482657260_wp
    fint(44,7) = 0.05178657643613000755857898715_wp*alpha - 0.05178657643613000755857898715_wp
    fint(45,7) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(46,7) = 0.2107209027515327118501721676_wp*alpha - 0.2107209027515327118501721676_wp
    fint(47,7) = -1.181014228762492651381540270_wp*alpha + 1.181014228762492651381540270_wp
    fint(48,7) = 2.637456845238095238095238095_wp*alpha - 2.637456845238095238095238095_wp
    fint(49,7) = -2.779844099059376837154614932_wp*alpha + 2.779844099059376837154614932_wp
    fint(50,7) = 0.6628848976704879482657260435_wp*alpha - 0.6628848976704879482657260435_wp
    fint(51,7) = 0.4497956821617535903250188964_wp*alpha + 0.0000000000000000000000000000_wp
    fint(52,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(53,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(54,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(55,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(56,7) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(57,7) = -0.4262670212375073486184597296_wp*alpha + 0.4262670212375073486184597296_wp
    fint(58,7) = 0.7558027860449735449735449735_wp*alpha - 0.7558027860449735449735449735_wp
    fint(59,7) = -0.4919167677101704879482657260_wp*alpha + 0.4919167677101704879482657260_wp
    fint(60,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(61,7) = 0.07187505052175191064079952969_wp*alpha + 0.0000000000000000000000000000_wp
    fint(62,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(63,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(64,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(65,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(66,7) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(67,7) = -0.04329003028680608045687410767_wp*alpha + 0.04329003028680608045687410767_wp
    fint(68,7) = 0.05178657643613000755857898715_wp*alpha - 0.05178657643613000755857898715_wp
    fint(69,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(70,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(71,7) = -0.01809930411207692953724699756_wp*alpha + 0.0000000000000000000000000000_wp
    fint(72,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(73,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(74,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(75,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(76,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(77,7) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(78,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(79,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(80,7) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(81,7) = -0.003571428571428571428571428571_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,8) = -0.09050595238095238095238095238_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(6,8) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(7,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,8) = 0.4166642632747543461829176115_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,8) = -0.4262670212375073486184597296_wp*alpha + 0.4262670212375073486184597296_wp
    fint(16,8) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(17,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,8) = -0.7125127557581674645166708659_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,8) = 0.7558027860449735449735449735_wp*alpha - 0.7558027860449735449735449735_wp
    fint(25,8) = -0.04329003028680608045687410767_wp*alpha + 0.04329003028680608045687410767_wp
    fint(26,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(27,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,8) = 0.4365587627026119089611153103_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,8) = -0.4919167677101704879482657260_wp*alpha + 0.4919167677101704879482657260_wp
    fint(34,8) = 0.05178657643613000755857898715_wp*alpha - 0.05178657643613000755857898715_wp
    fint(35,8) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(36,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(37,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(38,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(39,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(40,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,8) = 0.4497956821617535903250188964_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,8) = -0.5330722644767783656672545561_wp*alpha + 0.5330722644767783656672545561_wp
    fint(43,8) = 0.1178003918388342991517594692_wp*alpha - 0.1178003918388342991517594692_wp
    fint(44,8) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(45,8) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(46,8) = 0.09050595238095238095238095238_wp*alpha - 0.09050595238095238095238095238_wp
    fint(47,8) = -0.4262670212375073486184597296_wp*alpha + 0.4262670212375073486184597296_wp
    fint(48,8) = 0.7558027860449735449735449735_wp*alpha - 0.7558027860449735449735449735_wp
    fint(49,8) = -0.4919167677101704879482657260_wp*alpha + 0.4919167677101704879482657260_wp
    fint(50,8) = -0.5330722644767783656672545561_wp*alpha + 0.5330722644767783656672545561_wp
    fint(51,8) = 0.6049473149985302763080540858_wp*alpha + 0.0000000000000000000000000000_wp
    fint(52,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(53,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(54,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(55,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(56,8) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(57,8) = -0.04329003028680608045687410767_wp*alpha + 0.04329003028680608045687410767_wp
    fint(58,8) = 0.05178657643613000755857898715_wp*alpha - 0.05178657643613000755857898715_wp
    fint(59,8) = 0.1178003918388342991517594692_wp*alpha - 0.1178003918388342991517594692_wp
    fint(60,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(61,8) = -0.1358996959509112286890064668_wp*alpha + 0.0000000000000000000000000000_wp
    fint(62,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(63,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(64,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(65,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(66,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(67,8) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(68,8) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(69,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(70,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(71,8) = 0.03452380952380952380952380952_wp*alpha + 0.0000000000000000000000000000_wp
    fint(72,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(73,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(74,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(75,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(76,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(77,8) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(78,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(79,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(80,8) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(81,8) = -0.003571428571428571428571428571_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,9) = -0.009602757962753002435542118082_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(6,9) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(7,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,9) = 0.04329003028680608045687410767_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(14,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(15,9) = -0.04329003028680608045687410767_wp*alpha + 0.04329003028680608045687410767_wp
    fint(16,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,9) = -0.05535800500755857898715041572_wp*alpha + 0.0000000000000000000000000000_wp
    fint(22,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(23,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(24,9) = 0.05178657643613000755857898715_wp*alpha - 0.05178657643613000755857898715_wp
    fint(25,9) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(26,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(27,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(30,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(31,9) = -0.08327658231502477534223565970_wp*alpha + 0.0000000000000000000000000000_wp
    fint(32,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(33,9) = 0.1178003918388342991517594692_wp*alpha - 0.1178003918388342991517594692_wp
    fint(34,9) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(35,9) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(36,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(37,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(38,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(39,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(40,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,9) = 0.6049473149985302763080540858_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,9) = -0.7704235054747207524985302763_wp*alpha + 0.7704235054747207524985302763_wp
    fint(43,9) = 0.2000000000000000000000000000_wp*alpha - 0.2000000000000000000000000000_wp
    fint(44,9) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(45,9) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(46,9) = 0.009602757962753002435542118082_wp*alpha - 0.009602757962753002435542118082_wp
    fint(47,9) = -0.04329003028680608045687410767_wp*alpha + 0.04329003028680608045687410767_wp
    fint(48,9) = 0.05178657643613000755857898715_wp*alpha - 0.05178657643613000755857898715_wp
    fint(49,9) = 0.1178003918388342991517594692_wp*alpha - 0.1178003918388342991517594692_wp
    fint(50,9) = -0.7704235054747207524985302763_wp*alpha + 0.7704235054747207524985302763_wp
    fint(51,9) = 0.6345238095238095238095238095_wp*alpha + 0.0000000000000000000000000000_wp
    fint(52,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(53,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(54,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(55,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(56,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(57,9) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(58,9) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(59,9) = 0.2000000000000000000000000000_wp*alpha - 0.2000000000000000000000000000_wp
    fint(60,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(61,9) = -0.1654761904761904761904761905_wp*alpha + 0.0000000000000000000000000000_wp
    fint(62,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(63,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(64,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(65,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(66,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(67,9) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(68,9) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(69,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(70,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(71,9) = 0.03452380952380952380952380952_wp*alpha + 0.0000000000000000000000000000_wp
    fint(72,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(73,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(74,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(75,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(76,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(77,9) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(78,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(79,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(80,9) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(81,9) = -0.003571428571428571428571428571_wp*alpha + 0.0000000000000000000000000000_wp
    fint(1,10) = -0.003571428571428571428571428571_wp*alpha + 0.0000000000000000000000000000_wp
    fint(2,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(3,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(4,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(5,10) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(6,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(7,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(8,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(9,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(10,10) = 0.03452380952380952380952380952_wp*alpha + 0.0000000000000000000000000000_wp
    fint(11,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(12,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(13,10) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(14,10) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(15,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(16,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(17,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(18,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(19,10) = -0.1654761904761904761904761905_wp*alpha + 0.0000000000000000000000000000_wp
    fint(20,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(21,10) = 0.2000000000000000000000000000_wp*alpha - 0.2000000000000000000000000000_wp
    fint(22,10) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(23,10) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(24,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(25,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(26,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(27,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(28,10) = 0.6345238095238095238095238095_wp*alpha + 0.0000000000000000000000000000_wp
    fint(29,10) = -0.8000000000000000000000000000_wp*alpha + 0.8000000000000000000000000000_wp
    fint(30,10) = 0.2000000000000000000000000000_wp*alpha - 0.2000000000000000000000000000_wp
    fint(31,10) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(32,10) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(33,10) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(34,10) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(35,10) = 0.2000000000000000000000000000_wp*alpha - 0.2000000000000000000000000000_wp
    fint(36,10) = -0.8000000000000000000000000000_wp*alpha + 0.8000000000000000000000000000_wp
    fint(37,10) = 0.6345238095238095238095238095_wp*alpha + 0.0000000000000000000000000000_wp
    fint(38,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(39,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(40,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(41,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(42,10) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(43,10) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(44,10) = 0.2000000000000000000000000000_wp*alpha - 0.2000000000000000000000000000_wp
    fint(45,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(46,10) = -0.1654761904761904761904761905_wp*alpha + 0.0000000000000000000000000000_wp
    fint(47,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(48,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(49,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(50,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(51,10) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(52,10) = -0.03809523809523809523809523810_wp*alpha + 0.03809523809523809523809523810_wp
    fint(53,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(54,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(55,10) = 0.03452380952380952380952380952_wp*alpha + 0.0000000000000000000000000000_wp
    fint(56,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(57,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(58,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(59,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(60,10) = 0.003571428571428571428571428571_wp*alpha - 0.003571428571428571428571428571_wp
    fint(61,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(62,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(63,10) = 0.0000000000000000000000000000_wp*alpha + 0.0000000000000000000000000000_wp
    fint(64,10) = -0.003571428571428571428571428571_wp*alpha + 0.0000000000000000000000000000_wp

  end subroutine initfint8

  function fluxInviscid(uin,nswin,ibdloc)
    ! Arguments
    ! =========
    ! 
    ! flux point value
    integer, intent(in) :: ibdloc
    ! stencil width
    integer, intent(in) :: nswin
    ! solution data
    real(wp), intent(in) :: uin(1:nswin)

    ! Output
    ! ======
    real(wp) :: fluxInviscid

    ! Local Variables
    ! ===============
    integer :: i, j, kterm

    fluxInviscid = 0.0_wp

    kterm = 0
    do i = 1, nswin
      do j = 1, nswin
        kterm = kterm+1
        fluxInviscid = fluxInviscid + fint(kterm,ibdloc)*uin(i)*uin(j)*0.5_wp
      end do
    end do

  end function fluxInviscid

  subroutine initrbarint()

      ! number of boundary stencils
      nbstencil = 1
      nnzint = 3

      allocate(rbar(nnzint,nbstencil+1))
      allocate(jVsts(nbstencil+1))
      allocate(jVste(nbstencil+1))
      rbar = 0.0_wp
      rbar(1,1) = -1.5_wp
      rbar(2,1) = 2.0_wp
      rbar(3,1) = -0.5_wp
      rbar(1,2) = -1.0_wp
      rbar(2,2) = 1.0_wp
      rbar(3,2) = 0.0_wp
      jVsts(1) = 1
      jVste(1) = 3
      jVsts(2) = 0
      jVste(2) = 1

  end subroutine initrbarint

  subroutine initrbarint4()

    nbstencil = 4

    allocate(rbar(nbstencil+1,nbstencil+1))
    allocate(jVsts(nbstencil+1))
    allocate(jVste(nbstencil+1))

    rbar = 0.0_wp
    rbar(1,1) = -1.8333333333333333333333333333333333333_wp
    rbar(2,1) = 3.0000000000000000000000000000000000000_wp
    rbar(3,1) = -1.5000000000000000000000000000000000000_wp
    rbar(4,1) = 0.33333333333333333333333333333333333333_wp
    rbar(1,2) = -1.1250000000000000000000000000000000000_wp
    rbar(2,2) = 1.2291666666666666666666666666666666667_wp
    rbar(3,2) = -0.083333333333333333333333333333333333333_wp
    rbar(4,2) = -0.020833333333333333333333333333333333333_wp
    rbar(1,3) = 0.10416666666666666666666666666666666667_wp
    rbar(2,3) = -1.2291666666666666666666666666666666667_wp
    rbar(3,3) = 1.1458333333333333333333333333333333333_wp
    rbar(4,3) = -0.020833333333333333333333333333333333333_wp
    rbar(1,4) = 0.020833333333333333333333333333333333333_wp
    rbar(3,4) = -1.1458333333333333333333333333333333333_wp
    rbar(4,4) = 1.2083333333333333333333333333333333333_wp
    rbar(5,4) = -0.083333333333333333333333333333333333333_wp
    rbar(1,5) = 0.083333333333333333333333333333333333333_wp
    rbar(2,5) = -1.2500000000000000000000000000000000000_wp
    rbar(3,5) = 1.2500000000000000000000000000000000000_wp
    rbar(4,5) = -0.083333333333333333333333333333333333333_wp
    jVsts(1) = 1
    jVste(1) = 4
    jVsts(2) = 0
    jVste(2) = 3
    jVsts(3) = -1
    jVste(3) = 2
    jVsts(4) = -2
    jVste(4) = 2
    jVsts(5) = -1
    jVste(5) = 2

  end subroutine initrbarint4

  subroutine initrbarint6()

    nbstencil = 6

    allocate(rbar(nbstencil+1,nbstencil+1))
    allocate(jVsts(nbstencil+1))
    allocate(jVste(nbstencil+1))

    rbar = 0.0_wp
    rbar(1,1) = -2.2833333333333333333333333333333333333_wp
    rbar(2,1) = 5.0000000000000000000000000000000000000_wp
    rbar(3,1) = -5.0000000000000000000000000000000000000_wp
    rbar(4,1) = 3.3333333333333333333333333333333333333_wp
    rbar(5,1) = -1.2500000000000000000000000000000000000_wp
    rbar(6,1) = 0.20000000000000000000000000000000000000_wp
    rbar(1,2) = -1.1840277777777777777777777777777777778_wp
    rbar(2,2) = 1.3277777777777777777777777777777777778_wp
    rbar(3,2) = -0.070833333333333333333333333333333333333_wp
    rbar(4,2) = -0.10555555555555555555555555555555555556_wp
    rbar(5,2) = 0.032638888888888888888888888888888888889_wp
    rbar(1,3) = 0.14375000000000000000000000000000000000_wp
    rbar(2,3) = -1.1225212191358024691358024691358024691_wp
    rbar(3,3) = 0.76084876543209876543209876543209876543_wp
    rbar(4,3) = 0.25950231481481481481481481481481481481_wp
    rbar(5,3) = -0.030216049382716049382716049382716049383_wp
    rbar(6,3) = -0.011363811728395061728395061728395061728_wp
    rbar(1,4) = 0.072916666666666666666666666666666666667_wp
    rbar(2,4) = -0.29083912037037037037037037037037037037_wp
    rbar(3,4) = -0.83790702160493827160493827160493827160_wp
    rbar(4,4) = 1.2943016975308641975308641975308641975_wp
    rbar(5,4) = -0.28309027777777777777777777777777777778_wp
    rbar(6,4) = 0.051599151234567901234567901234567901235_wp
    rbar(7,4) = -0.0069810956790123456790123456790123456790_wp
    rbar(1,5) = -0.032638888888888888888888888888888888889_wp
    rbar(2,5) = 0.074218750000000000000000000000000000000_wp
    rbar(3,5) = 0.19689236111111111111111111111111111111_wp
    rbar(4,5) = -1.5987152777777777777777777777777777778_wp
    rbar(5,5) = 1.5127430555555555555555555555555555556_wp
    rbar(6,5) = -0.19217013888888888888888888888888888889_wp
    rbar(7,5) = 0.039670138888888888888888888888888888889_wp
    rbar(1,6) = 0.011363811728395061728395061728395061728_wp
    rbar(2,6) = -0.055981867283950617283950617283950617284_wp
    rbar(3,6) = 0.19711805555555555555555555555555555556_wp
    rbar(4,6) = -1.4322029320987654320987654320987654321_wp
    rbar(5,6) = 1.4512712191358024691358024691358024691_wp
    rbar(6,6) = -0.18267939814814814814814814814814814815_wp
    rbar(7,6) = 0.011111111111111111111111111111111111111_wp
    rbar(1,7) = 0.0069810956790123456790123456790123456790_wp
    rbar(2,7) = -0.046651234567901234567901234567901234568_wp
    rbar(3,7) = 0.21123842592592592592592592592592592593_wp
    rbar(4,7) = -1.4271141975308641975308641975308641975_wp
    rbar(5,7) = 1.3833236882716049382716049382716049383_wp
    rbar(6,7) = -0.13888888888888888888888888888888888889_wp
    rbar(7,7) = 0.011111111111111111111111111111111111111_wp
    jVsts(1) = 1
    jVste(1) = 6
    jVsts(2) = 0
    jVste(2) = 4
    jVsts(3) = -1
    jVste(3) = 4
    jVsts(4) = -2
    jVste(4) = 4
    jVsts(5) = -3
    jVste(5) = 3
    jVsts(6) = -3
    jVste(6) = 3
    jVsts(7) = -3
    jVste(7) = 3

  end subroutine initrbarint6

  subroutine initrbarint8()

    nbstencil = 8

    allocate(rbar(nbstencil+1,nbstencil+1))
    allocate(jVsts(nbstencil+1))
    allocate(jVste(nbstencil+1))

    rbar = 0.0_wp
    rbar(1,1) = -2.4500000000000000000000000000000000000_wp
    rbar(2,1) = 6.0000000000000000000000000000000000000_wp
    rbar(3,1) = -7.5000000000000000000000000000000000000_wp
    rbar(4,1) = 6.6666666666666666666666666666666666667_wp
    rbar(5,1) = -3.7500000000000000000000000000000000000_wp
    rbar(6,1) = 1.2000000000000000000000000000000000000_wp
    rbar(7,1) = -0.16666666666666666666666666666666666667_wp
    rbar(1,2) = -1.1602083333333333333333333333333333333_wp
    rbar(2,2) = 1.1564166666666666666666666666666666667_wp
    rbar(3,2) = 0.34108333333333333333333333333333333333_wp
    rbar(4,2) = -0.56016666666666666666666666666666666667_wp
    rbar(5,2) = 0.27245833333333333333333333333333333333_wp
    rbar(6,2) = -0.049583333333333333333333333333333333333_wp
    rbar(1,3) = 0.093973038486880787332060994325567220421_wp
    rbar(2,3) = -0.78549893930185917599538939754826348881_wp
    rbar(3,3) = 0.046946483020436971650521028934066801314_wp
    rbar(4,3) = 0.90729349114883760012958720175606131931_wp
    rbar(5,3) = -0.26981952253301897863082607780986533944_wp
    rbar(6,3) = -0.0063708948742115737446125435968063627529_wp
    rbar(7,3) = 0.013476344052934369258658793939239849966_wp
    rbar(1,4) = 0.078746435191005348453800791189557639584_wp
    rbar(2,4) = -0.35162113760879514268346232087309277418_wp
    rbar(3,4) = -0.78713436791133549855006393774752877572_wp
    rbar(4,4) = 1.3893360044549165552850116426510172239_wp
    rbar(5,4) = -0.45575020893114105530342782230270280369_wp
    rbar(6,4) = 0.19808018162235668097172402106009418736_wp
    rbar(7,4) = -0.092080135398545507498723070166851812875_wp
    rbar(8,4) = 0.020423228581538619325140696189507115568_wp
    rbar(1,5) = 0.032926148937526826310667271834304379849_wp
    rbar(2,5) = -0.25191802597411192851286613885119855940_wp
    rbar(3,5) = 0.86404038300564659933759665503107585561_wp
    rbar(4,5) = -2.2705734372043358134175184621100160529_wp
    rbar(5,5) = 1.9056036402801850141544340055650364152_wp
    rbar(6,5) = -0.43544242414791128227318211540346767698_wp
    rbar(7,5) = 0.20103197771146276694189556489629198797_wp
    rbar(8,5) = -0.049509365793563383515243628194746597938_wp
    rbar(9,5) = 0.0038411031851012009742168472327202485933_wp
    rbar(1,6) = -0.049583333333333333333333333333333333333_wp
    rbar(2,6) = 0.24538547964509061280525769040437984250_wp
    rbar(3,6) = -0.46041931266967499182355759462391059263_wp
    rbar(4,6) = 0.46614273043637761869004215693100311426_wp
    rbar(5,6) = -1.3962385850218969553701412457089944128_wp
    rbar(6,6) = 1.3149492005817200178282234837505867257_wp
    rbar(7,6) = -0.13710317505277669221310366487172969582_wp
    rbar(8,6) = 0.025083621435175386943099478252132619196_wp
    rbar(9,6) = -0.0082166260206816635264869708001342671278_wp
    rbar(1,7) = 0.013476344052934369258658793939239849966_wp
    rbar(2,7) = -0.095466650296571124068030350198485565808_wp
    rbar(3,7) = 0.28303601526589854838736615694592248492_wp
    rbar(4,7) = -0.37189053652589385913924939420370302618_wp
    rbar(5,7) = -0.87133674643234682661783233764660965659_wp
    rbar(6,7) = 1.1363503084863723276987369694549351287_wp
    rbar(7,7) = -0.10962852877844960704052530455432144803_wp
    rbar(8,7) = 0.017245508513770457235161180548736518789_wp
    rbar(9,7) = -0.0017857142857142857142857142857142857143_wp
    rbar(1,8) = 0.020423228581538619325140696189507115568_wp
    rbar(2,8) = -0.11461749320859847500014290897545707151_wp
    rbar(3,8) = 0.24553622332394432725008432375299558042_wp
    rbar(4,8) = -0.14002362171685620274536032506670231808_wp
    rbar(5,8) = -1.2086425337884685391310360256213220479_wp
    rbar(6,8) = 1.3257988165251715762302257817106939321_wp
    rbar(7,8) = -0.15030001654212813132573693881511201603_wp
    rbar(8,8) = 0.023611111111111111111111111111111111111_wp
    rbar(9,8) = -0.0017857142857142857142857142857142857143_wp
    rbar(1,9) = 0.0038411031851012009742168472327202485933_wp
    rbar(2,9) = -0.021645015143403040228437053833879230705_wp
    rbar(3,9) = 0.036310098576467624086671705719324766944_wp
    rbar(4,9) = 0.094189280727723188040648358108675568993_wp
    rbar(5,9) = -1.3644581220605526161081716637272192828_wp
    rbar(6,9) = 1.4063261467781557067271352985638699924_wp
    rbar(7,9) = -0.17638888888888888888888888888888888889_wp
    rbar(8,9) = 0.023611111111111111111111111111111111111_wp
    rbar(9,9) = -0.0017857142857142857142857142857142857143_wp
    jVsts(1) = 1
    jVste(1) = 7
    jVsts(2) = 0
    jVste(2) = 5
    jVsts(3) = -1
    jVste(3) = 5
    jVsts(4) = -2
    jVste(4) = 5
    jVsts(5) = -3
    jVste(5) = 5
    jVsts(6) = -4
    jVste(6) = 4
    jVsts(7) = -4
    jVste(7) = 4
    jVsts(8) = -4
    jVste(8) = 4
    jVsts(9) = -4
    jVste(9) = 4

  end subroutine initrbarint8


  function fluxViscous(uin,nswin,ibdloc)
    ! Arguments
    ! =========
    !
    ! flux point value
    integer, intent(in) :: ibdloc
    ! stencil width
    integer, intent(in) :: nswin
    ! solution data
    real(wp), intent(in) :: uin(1:nswin)

    ! Output
    ! ======
    real(wp) :: fluxViscous

    ! Local Variables
    ! ===============
    integer :: i

    fluxViscous = 0.0_wp

      do i = 1,nswin
        fluxViscous = fluxViscous + eps*rbar(i,ibdloc)*uin(i)/delta_x
      end do

  end function fluxViscous

end module fluxfunctions

module subroutines

  use precision_vars
  use globaldata
  use fluxfunctions
  implicit none

  contains
! Calculate Spatial Centered Difference and Include SAT Boundary Conditions
  subroutine spatial_penalty

    use globaldata
    use precision_vars
    use fluxfunctions
    implicit none
    real(wp) :: tau,amax,amin, satl, satr
    real(wp), allocatable :: fp(:)
    integer :: nsw

    allocate(fp(0:jmax))


!   Set amax and amin
    amax = max(0.5_wp*(u(1)+gl(x(1),time)),0.0_wp)
    amin = min(0.5_wp*(u(jmax)+gr(x(jmax),time)),0.0_wp)

!   Left Boundary: Flux Point Index
    do i = 0,nbstencil-1
!     Stencil Width
      nsw = jIste(i+1)-jIsts(i+1)+1
!     Call Flux Function
      fp(i) = fluxInviscid(u(i+jIsts(i+1):i+jIste(i+1)),nsw,i+1)
    end do

!   Interior: Flux Point Index
    nsw = jIste(nbstencil+1)-jIsts(nbstencil+1)+1
    do i = nbstencil,jmax-nbstencil
!     Call Flux Function
      fp(i) = fluxInviscid(u(i+jIsts(nbstencil+1):i+jIste(nbstencil+1)),nsw,nbstencil+1)
    end do

!   Right Boundary: Flux Point Index
    do j = 1,nbstencil
      i = jmax-(j-1)
!     Stencil Width
      nsw = jIste(j)-jIsts(j)+1
!     Call Flux Function
      fp(i) = fluxInviscid(u(i+1-jIsts(j):i+1-jIste(j):-1),nsw,j)
    end do

!   Left Boundary dU/dt: Flux Point Index
    i = 1
!   SAT Boundary Condition
    satl = pinvdx(1,order/2)*amax*(u(i)-gl(x(i),time))/delta_x

!   Right Boundary dU/dt: Flux Point Index
    i = jmax
!   SAT Boundary Condition
    satr = pinvdx(1,order/2)*amin*(u(i)-gr(x(i),time))/delta_x

  !   Left Offsets: Flux Point Index
      do i=1,nbstencil
  !     Calculate dU/dt from Pinv*Delta*fbar
        q(i) = pinvdx(i,order/2)*(fp(i)-fp(i-1))/delta_x
      end do

  !   Right Offsets: Flux Point Index
      do i=jmax-nbstencil+1,jmax
        j = jmax-(i-1)
  !     Calculate dU/dt from Pinv*Delta*fbar
        q(i) = pinvdx(j,order/2)*(fp(i)-fp(i-1))/delta_x
      end do
!     end if

!   Interior: Flux Point Index
    do i=nbstencil+1,jmax-nbstencil
!     Calculate dU/dt from Pinv*Delta*fbar
      q(i) = pinvdx(nbstencil+1,order/2)*(fp(i)-fp(i-1))/delta_x
    end do

    q(1) = q(1) + satl
    q(jmax) = q(jmax) - satr

! do i=0,jmax
! write(*,*) i,fp(i)
! end do
! write(*,*) ' '
! do i = 1,jmax
!   write(*,*) i, q(i)
! end do
! stop
  deallocate(fp)
  end subroutine spatial_penalty

! Central differencing in space (viscous case)
  subroutine spatial_viscous
!   Inviscid Stencil Width
    integer :: nsw
!   Viscous Stencil Width
    integer :: nswv
    real(wp) :: bcli,bcri,au,ag
!   Array for flux point values
    real(wp), allocatable :: fp(:)

    allocate(fp(0:jmax))

!   Left Boundary: Flux Point Index
    do i = 0,nbstencil-1
!     Stencil Width
      nsw = jIste(i+1)-jIsts(i+1)+1
      nswv = jVste(i+1)-jVsts(i+1)+1
!     Call Flux Function
      fp(i) = fluxInviscid(u(i+jIsts(i+1):i+jIste(i+1)),nsw,i+1) &
         & -fluxViscous(u(i+jVsts(i+1):i+jVste(i+1)),nswv,i+1)
!      write(*,*) i, fp(i)
!      write(*,*) u(i+jIsts(nbstencil+1):i+jIste(nbstencil+1))
    end do

!   Interior: Flux Point Index
    nsw = jIste(nbstencil+1)-jIsts(nbstencil+1)+1
    nswv = jVste(nbstencil+1)-jVsts(nbstencil+1)+1
    do i = nbstencil,jmax-nbstencil
!     Call Flux Function
      fp(i) = fluxInviscid(u(i+jIsts(nbstencil+1):i+jIste(nbstencil+1)),nsw,nbstencil+1)  &
         &  -fluxViscous(u(i+jVsts(nbstencil+1):i+jVste(nbstencil+1)),nswv,nbstencil+1)
!      write(*,*) i, fp(i)
!      write(*,*) u(i+jIsts(nbstencil+1):i+jIste(nbstencil+1))
    end do

!   Right Boundary: Flux Point Index
    do j = 1,nbstencil
      i = jmax-(j-1)
!     Stencil Width
      nsw = jIste(j)-jIsts(j)+1
      nswv = jVste(j)-jVsts(j)+1
!     Call Flux Function
      fp(i) = fluxInviscid(u(i+1-jIsts(j):i+1-jIste(j):-1),nsw,j)  &
       &  +fluxViscous(u(i+1-jVsts(j):i+1-jVste(j):-1),nswv,j)
!        &  +fluxViscous(u(i+1-jVsts(nbstencil-(j-1)):i+1-jVste(nbstencil-(j-1)):-1),nswv,nbstencil+1-j)
!      write(*,*) i, fp(i)
!      write(*,*) u(i+jIsts(nbstencil+1):i+jIste(nbstencil+1))
    end do


!   dU/dt index
    i = 1
    au = (1.0_wp/3.0_wp)*(u(i)+abs(u(i)))
    ag = (1.0_wp/3.0_wp)*(gl(x(i),time)+abs(gl(x(i),time)))
    bcli = -pinvdx(1,order/2)*(au*u(i)-ag*gl(x(i),time))/delta_x
!   Left Offsets: Flux Point Index
    do i=1,nbstencil
!     Calculate dU/dt from Pinv*Delta*fbar
      q(i) = pinvdx(i,order/2)*(fp(i)-fp(i-1))/delta_x
    end do

!   dU/dt index
    i = jmax
    au = (1.0_wp/3.0_wp)*(u(i)-abs(u(i)))
    ag = (1.0_wp/3.0_wp)*(gr(x(i),time)-abs(gr(x(i),time)))
    bcri = pinvdx(1,order/2)*(au*u(i)-ag*gr(x(i),time))/delta_x
!   Right Offsets: Flux Point Index
    do i=jmax-nbstencil+1,jmax
      j = jmax-(i-1)
!     Calculate dU/dt from Pinv*Delta*fbar
      q(i) = pinvdx(j,order/2)*(fp(i)-fp(i-1))/delta_x
    end do

!   dU/dt index
!   Interior: Flux Point Index
    do i=nbstencil+1,jmax-nbstencil
!     Calculate dU/dt from Pinv*Delta*fbar
      q(i) = pinvdx(nbstencil+1,order/2)*(fp(i)-fp(i-1))/delta_x
    end do

    q(1) = q(1) - bcli
    q(jmax) = q(jmax) - bcri
! do i=0,jmax
! write(*,*) i,fp(i)
! end do
! stop
  deallocate(fp)
  end subroutine spatial_viscous

  subroutine energy(uin,pin)

    real(wp), intent(in) :: uin(1:jmax)
    real(wp), intent(inout) :: pin

    pin = pin + 0.25_wp*delta_x*uin(1)**2
    do i=2,jmax-1
      pin = pin + 0.5_wp*delta_x*uin(i)**2
    end do
    pin = pin + 0.25_wp*delta_x*uin(jmax)**2

  end subroutine energy

  subroutine l2errornorm(uin,uein,l2error)

    real(wp), intent(in) :: uin(1:jmax)
    real(wp), intent(in) :: uein(1:jmax)
    real(wp), intent(inout) :: l2error
    real(wp) :: l2variance

    l2variance = 0.0_wp
    do i=1,jmax
      l2variance = l2variance + (uein(i)-uin(i))**2
    end do

    l2error = sqrt(l2variance/real(jmax,wp))

  end subroutine l2errornorm

  subroutine linferrornorm(uin,uein,linferror)

    real(wp), intent(in) :: uin(1:jmax)
    real(wp), intent(in) :: uein(1:jmax)
    real(wp), intent(inout) :: linferror
    real(wp) :: linfvariance
    real(wp) :: suplinfvariance

    suplinfvariance = maxval(uein(1:jmax)-uin(1:jmax))**2
    linferror = sqrt(suplinfvariance)

  end subroutine linferrornorm

  subroutine tecplot_write_1d(xin,uin,tin,nc,varname,fname)

    ! Arguments
    ! =========
    !
    ! number of cells
    integer, intent(in) :: nc
    ! grid variable
    real(wp), intent(in), dimension(nc) :: xin
    ! solution variable
    real(wp), intent(in), dimension(nc) :: uin
    ! solution time
    real(wp), intent(in) :: tin
    ! variable name
    character(*), intent(in), optional :: varname
    ! file name
    character(*), intent(in), optional :: fname

    ! local variables
    ! ===============
    !
    integer :: iunit, i, j, ierr
    character(80) :: var, filename

    iunit = 37
    if (present(varname)) then
      var = varname
    else 
      var = 'u'
    end if
    ! use either the given filename or the default
    if (present(fname)) then
      filename = fname
    else
      ! this is the default
      filename = 'tec_output.dat'
    end if

    ! if writing initial data, remove the old file if it exists
    if (tin <= 0.0_wp) then
      open(unit = iunit, file = trim(filename), action = 'read', &
        & status = 'old', iostat = ierr)
      if (ierr /= 0) then
        close(iunit)
      else
        close(iunit, status = 'delete')
      end if
    end if 

    ! open the file and append to it if it already exists
    open(unit = iunit, file = trim(filename), action = 'write',  &
      & status = 'old', position = 'append', iostat = ierr)
    ! if the file does not exist, create it
    if (ierr /= 0) then
      close(iunit)
      open(unit = iunit, file = trim(filename), action = 'write', &
        & status = 'replace', iostat = ierr)
    end if
    ! write variable list
    write(iunit,*) 'VARIABLES=x,',trim(var)
    ! write tag for zone
    write(iunit,131) tin
    131 format('ZONE T="t = ',ES20.13,'"')
    ! write data using implied do loop
    !do i=1,nc
      !write (iunit,132) xin(i),uin(i)
     ! write (*,132) xin(i),uin(i)
    !end do
    write(iunit,132) (xin(i), uin(i), i = 1,nc)
    132 format(2(ES20.13,2X))
    close(iunit)
  end subroutine tecplot_write_1d

end module subroutines

module rungekutta

  use precision_vars
  implicit none

  real(wp), allocatable :: rkint(:,:)

  contains

  subroutine initrkint33()

      integer :: storage
      integer :: stages

      ! Number of vectors to store for routine
      storage = 2
      ! Stages in RK scheme
      stages = 3

      allocate(rkint(stages,storage))
      rkint = 0.0_wp
      rkint(1,2) = 1.0_wp/3.0_wp
      rkint(2,1) = -5.0_wp/9.0_wp
      rkint(2,2) = 15.0_wp/16.0_wp
      rkint(3,1) = -153.0_wp/128.0_wp
      rkint(3,2) = 8.0_wp/15.0_wp

  end subroutine initrkint33

  subroutine initrkint54()

      integer :: storage
      integer :: stages

      ! Number of vectors to store for routine
      storage = 2
      ! Stages in RK scheme
      stages = 5

      allocate(rkint(stages,storage))
      rkint(1,1) = 0.0_wp
      rkint(2,1) = -0.4178904745_wp
      rkint(3,1) = -1.192151694643_wp
      rkint(4,1) = -1.697784692471_wp
      rkint(5,1) = -1.514183444257_wp
      rkint(1,2) = 0.1496590219993_wp
      rkint(2,2) = 0.3792103129999_wp
      rkint(3,2) = 0.8229550293869_wp
      rkint(4,2) = 0.6994504559488_wp
      rkint(5,2) = 0.1530572479681_wp

  end subroutine initrkint54

  pure elemental subroutine rk(uin,qin,dt,irk,du)

    ! Arguments
    ! =========
    !
    ! Time Step
    real(wp), intent(in) :: dt
    ! solution data
    real(wp), intent(inout) :: uin
    ! solution data
    real(wp), intent(in) :: qin
    ! book-keeping data
    real(wp), intent(inout) :: du
    ! rungekutta stages
    integer, intent(in) :: irk

    ! Local Variables
    ! ===============
    integer :: kterm

    kterm = 1
    du = rkint(irk,kterm)*du + dt*qin
    kterm = 2
    uin = uin + rkint(irk,kterm)*du

  end subroutine rk

end module rungekutta


program burgers_test

  use precision_vars
  use globaldata
  use fluxfunctions
  use subroutines
  use rungekutta
  implicit none

  integer :: isnap,choice,irk,steps,rkstages,r
  real(wp) :: cfl,end_time,delta_t,time_steps,dtsnap
  real(wp), allocatable :: ue(:)

! Setup spatial grid parameters
  print *, 'Number of points ='
  read *, jmax
  print *, 'Method Choice (1: No SAT, 2: SAT, 3: Shock Capture, 4: Viscous) ='
  read *, choice
  print *, 'Order (2,4,6,8) ='
  read *, order
  print *, 'Runge Kutta Scheme Stages (3,5) ='
  read *, rkstages

  allocate(x(jmax),u(1:jmax),q(jmax),du(jmax),ue(jmax))

!  xmin = -1.0_wp
  xmin = -10.0_wp
!  xmax = 1.0_wp
  xmax = 10.0_wp
  delta_x = (xmax-xmin)/real(jmax-1,wp)
  alpha = 2.0_wp/3.0_wp
  L2error = 0.0_wp
  Linferror = 0.0_wp


! Grid setup
  do j=1,jmax
    x(j) = xmin + delta_x*real(j-1,wp)
  end do

! Set initial condition
  do j=1,jmax
    u(j) = g(x(j),0.0_wp)
  end do

! Setup time & cfl parameters
  time = 0.0_wp
  end_time = 10.0_wp
!  end_time = 1.5_wp
!  end_time = 20.0_wp
!  end_time = 0.05_wp
  cfl = 0.1_wp
  if (choice <=2) then
    delta_t = cfl*delta_x
  else if (choice > 2) then
    delta_t = cfl*delta_x**2
  end if
  isnap = 1
  dtsnap = 0.1_wp
  time_steps = (end_time-time)/delta_t
  steps = ceiling(time_steps)

  allocate(e(steps+1),t(steps+1))

  if (rkstages == 3) then
    call initrkint33
  else if (rkstages == 5) then
    call initrkint54
  end if
  call initpinvdx
! Initialize inviscid flux point coefficients
  if (order == 2) then
    call initfint
    if (choice > 2) then
      call initrbarint
    end if
  else if (order == 4) then
    call initfint4
    if (choice > 2) then
      call initrbarint4
    end if
  else if (order == 6) then
    call initfint6
    if (choice > 2) then
      call initrbarint6
    end if
  else if (order == 8) then
    call initfint8
    if (choice > 2) then
      call initrbarint8
    end if
  end if

  call tecplot_write_1d(x,u,0.0_wp,jmax,'u','shock.dat')
  r = 1

  select case (choice)

    case(2)
      do
        do irk=1,rkstages
          call spatial_penalty
          call rk(u,-q,delta_t,irk,du)
        end do
        p = 0.0_wp
        call energy(u,p)
        e(isnap) = p
        t(isnap) = time
        time = time + delta_t

        if (time>=end_time) then
          exit
        elseif (time>r*dtsnap) then
          call tecplot_write_1d(x,u,time,jmax,'u','shock.dat')
          r = r+1
        end if
        if (time>=end_time) then
          exit
        else
         isnap = isnap + 1
        end if
      end do

      do i=1,jmax
        ue(i) = g(x(i),time)
      end do
      call l2errornorm(u(1:jmax),ue(1:jmax),L2error)
      call linferrornorm(u(1:jmax),ue(1:jmax),Linferror)
      call tecplot_write_1d(x,ue,0.0_wp,jmax,'ue','exact_shock.dat')
      call tecplot_write_1d(x,u,time,jmax,'u','shock.dat')
      call tecplot_write_1d(t,e,0.0_wp,steps,'E','energy.dat')

write(*,*) L2error,Linferror

    case(4)
      do
        do irk=1,rkstages
          !write(*,*) u
          call spatial_viscous
          !write(*,*) q
          !stop
          call rk(u,-q,delta_t,irk,du)
        end do
        p = 0.0_wp
        call energy(u,p)
        e(isnap) = p
        t(isnap) = time
        time = time + delta_t
        if (time>=end_time) then
          exit
        elseif (time>r*dtsnap) then
          call tecplot_write_1d(x,u,time,jmax,'u','shock.dat')
          r = r+1
        end if
        if (time>=end_time) then
          exit
        else
         isnap = isnap + 1
        end if
      end do

      do i=1,jmax
        ue(i) = g(x(i),time)
      end do
      call l2errornorm(u(1:jmax),ue(1:jmax),L2error)
      call linferrornorm(u(1:jmax),ue(1:jmax),Linferror)
      call tecplot_write_1d(x,ue,0.0_wp,jmax,'ue','exact_shock.dat')
      call tecplot_write_1d(x,u,time,jmax,'u','shock.dat')
      call tecplot_write_1d(t,e,0.0_wp,steps,'E','energy.dat')

write(*,*) L2error,Linferror

  end select

end program burgers_test